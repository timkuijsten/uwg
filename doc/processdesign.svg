<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: G Pages: 1 -->
<svg width="327pt" height="911pt"
 viewBox="0.00 0.00 327.37 910.62" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 906.6224)">
<title>G</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-906.6224 323.3681,-906.6224 323.3681,4 -4,4"/>
<text text-anchor="start" x="8" y="-20.8" font-family="Times,serif" font-size="14.00" fill="#000000">Version 0.5</text>
<text text-anchor="start" x="8" y="-6.8" font-family="Times,serif" font-size="14.00" fill="#000000">2019&#45;01&#45;27</text>
<!-- usock -->
<g id="node1" class="node">
<title>usock</title>
<ellipse fill="none" stroke="#000000" cx="149.3994" cy="-877.1665" rx="61.1765" ry="25.4118"/>
<text text-anchor="middle" x="149.3994" y="-879.9665" font-family="Times,serif" font-size="14.00" fill="#000000">unconnected</text>
<text text-anchor="middle" x="149.3994" y="-865.9665" font-family="Times,serif" font-size="14.00" fill="#000000">socket</text>
</g>
<!-- PROXY -->
<g id="node2" class="node">
<title>PROXY</title>
<polygon fill="none" stroke="#000000" points="101.3579,-649.2107 101.3579,-759.2107 197.4409,-759.2107 197.4409,-649.2107 101.3579,-649.2107"/>
<text text-anchor="middle" x="149.3994" y="-744.0107" font-family="Times,serif" font-size="14.00" fill="#000000">PROXY</text>
<polyline fill="none" stroke="#000000" points="101.3579,-737.2107 197.4409,-737.2107 "/>
<text text-anchor="middle" x="149.3994" y="-722.0107" font-family="Times,serif" font-size="14.00" fill="#000000">pledge stdio</text>
<polyline fill="none" stroke="#000000" points="101.3579,-715.2107 197.4409,-715.2107 "/>
<text text-anchor="middle" x="149.3994" y="-700.0107" font-family="Times,serif" font-size="14.00" fill="#000000">bind(2)</text>
<polyline fill="none" stroke="#000000" points="101.3579,-693.2107 197.4409,-693.2107 "/>
<text text-anchor="middle" x="149.3994" y="-678.0107" font-family="Times,serif" font-size="14.00" fill="#000000">ifn mac1 key</text>
<polyline fill="none" stroke="#000000" points="101.3579,-671.2107 197.4409,-671.2107 "/>
<text text-anchor="middle" x="149.3994" y="-656.0107" font-family="Times,serif" font-size="14.00" fill="#000000">ifn cookie key</text>
</g>
<!-- usock&#45;&gt;PROXY -->
<g id="edge1" class="edge">
<title>usock&#45;&gt;PROXY</title>
<path fill="none" stroke="#000000" d="M117.0724,-855.0016C110.6356,-848.9117 104.7648,-841.7407 101.1923,-833.7107 91.0756,-810.9706 94.0694,-801.5585 101.1923,-777.7107 102.0808,-774.736 103.1325,-771.77 104.3159,-768.83"/>
<polygon fill="#000000" stroke="#000000" points="107.5804,-770.105 108.5046,-759.5505 101.2003,-767.225 107.5804,-770.105"/>
<text text-anchor="start" x="101.3994" y="-822.5107" font-family="Times,serif" font-size="14.00" fill="#000000">WGINIT</text>
<text text-anchor="start" x="101.3994" y="-808.5107" font-family="Times,serif" font-size="14.00" fill="#000000">WGRESP</text>
<text text-anchor="start" x="101.3994" y="-794.5107" font-family="Times,serif" font-size="14.00" fill="#000000">WGCOOKIE</text>
<text text-anchor="start" x="101.3994" y="-780.5107" font-family="Times,serif" font-size="14.00" fill="#000000">WGDATA</text>
</g>
<!-- PROXY&#45;&gt;usock -->
<g id="edge3" class="edge">
<title>PROXY&#45;&gt;usock</title>
<path fill="none" stroke="#000000" d="M173.495,-759.4794C180.4518,-782.6108 184.4773,-809.6581 177.3994,-833.7107 176.4065,-837.0847 175.0615,-840.444 173.4954,-843.714"/>
<polygon fill="#000000" stroke="#000000" points="170.3447,-842.1804 168.6054,-852.6315 176.4825,-845.5462 170.3447,-842.1804"/>
<text text-anchor="middle" x="219.5029" y="-801.5107" font-family="Times,serif" font-size="14.00" fill="#000000">WGCOOKIE</text>
</g>
<!-- IFN -->
<g id="node4" class="node">
<title>IFN</title>
<polygon fill="none" stroke="#000000" points="34.1406,-199.2107 34.1406,-375.2107 156.6582,-375.2107 156.6582,-199.2107 34.1406,-199.2107"/>
<text text-anchor="middle" x="95.3994" y="-360.0107" font-family="Times,serif" font-size="14.00" fill="#000000">IFN</text>
<polyline fill="none" stroke="#000000" points="34.1406,-353.2107 156.6582,-353.2107 "/>
<text text-anchor="middle" x="95.3994" y="-338.0107" font-family="Times,serif" font-size="14.00" fill="#000000">pledge stdio inet</text>
<polyline fill="none" stroke="#000000" points="34.1406,-331.2107 156.6582,-331.2107 "/>
<text text-anchor="middle" x="95.3994" y="-316.0107" font-family="Times,serif" font-size="14.00" fill="#000000">/dev/tun</text>
<polyline fill="none" stroke="#000000" points="34.1406,-309.2107 156.6582,-309.2107 "/>
<text text-anchor="middle" x="95.3994" y="-294.0107" font-family="Times,serif" font-size="14.00" fill="#000000">mac1 key</text>
<polyline fill="none" stroke="#000000" points="34.1406,-287.2107 156.6582,-287.2107 "/>
<text text-anchor="middle" x="95.3994" y="-272.0107" font-family="Times,serif" font-size="14.00" fill="#000000">cookie key</text>
<polyline fill="none" stroke="#000000" points="34.1406,-265.2107 156.6582,-265.2107 "/>
<text text-anchor="middle" x="95.3994" y="-250.0107" font-family="Times,serif" font-size="14.00" fill="#000000">peer transport keys</text>
<polyline fill="none" stroke="#000000" points="34.1406,-243.2107 156.6582,-243.2107 "/>
<text text-anchor="middle" x="95.3994" y="-228.0107" font-family="Times,serif" font-size="14.00" fill="#000000">peer connect(2)</text>
<polyline fill="none" stroke="#000000" points="34.1406,-221.2107 156.6582,-221.2107 "/>
<text text-anchor="middle" x="95.3994" y="-206.0107" font-family="Times,serif" font-size="14.00" fill="#000000">peer timers</text>
</g>
<!-- PROXY&#45;&gt;IFN -->
<g id="edge4" class="edge">
<title>PROXY&#45;&gt;IFN</title>
<path fill="none" stroke="#000000" d="M101.0805,-675.0161C71.3378,-654.0363 35.8019,-622.7889 19.0527,-584.7107 -15.1978,-506.8445 1.9735,-473.5252 31.3994,-393.7107 32.4837,-390.7696 33.6511,-387.8193 34.8887,-384.8702"/>
<polygon fill="#000000" stroke="#000000" points="38.2036,-386.0291 39.064,-375.4693 31.8062,-383.1878 38.2036,-386.0291"/>
<text text-anchor="start" x="19.3994" y="-522.0107" font-family="Times,serif" font-size="14.00" fill="#000000">α WGDATA</text>
</g>
<!-- ENCLAVE -->
<g id="node5" class="node">
<title>ENCLAVE</title>
<polygon fill="none" stroke="#000000" points="99.0302,-468.2107 99.0302,-584.2107 199.7685,-584.2107 199.7685,-468.2107 99.0302,-468.2107"/>
<text text-anchor="middle" x="149.3994" y="-569.0107" font-family="Times,serif" font-size="14.00" fill="#000000">ENCLAVE</text>
<polyline fill="none" stroke="#000000" points="99.0302,-562.2107 199.7685,-562.2107 "/>
<text text-anchor="middle" x="149.3994" y="-547.0107" font-family="Times,serif" font-size="14.00" fill="#000000">pledge stdio</text>
<polyline fill="none" stroke="#000000" points="99.0302,-540.2107 199.7685,-540.2107 "/>
<text text-anchor="middle" x="149.3994" y="-525.0107" font-family="Times,serif" font-size="14.00" fill="#000000">ifn private and</text>
<text text-anchor="middle" x="149.3994" y="-511.0107" font-family="Times,serif" font-size="14.00" fill="#000000">pre&#45;sharedkeys</text>
<polyline fill="none" stroke="#000000" points="99.0302,-504.2107 199.7685,-504.2107 "/>
<text text-anchor="middle" x="149.3994" y="-489.0107" font-family="Times,serif" font-size="14.00" fill="#000000">peer static</text>
<text text-anchor="middle" x="149.3994" y="-475.0107" font-family="Times,serif" font-size="14.00" fill="#000000">public keys</text>
</g>
<!-- PROXY&#45;&gt;ENCLAVE -->
<g id="edge5" class="edge">
<title>PROXY&#45;&gt;ENCLAVE</title>
<path fill="none" stroke="#000000" d="M149.3994,-648.8661C149.3994,-631.6383 149.3994,-612.4374 149.3994,-594.4372"/>
<polygon fill="#000000" stroke="#000000" points="152.8995,-594.2924 149.3994,-584.2925 145.8995,-594.2925 152.8995,-594.2924"/>
<text text-anchor="start" x="149.3994" y="-619.5107" font-family="Times,serif" font-size="14.00" fill="#000000">α WGINIT</text>
<text text-anchor="start" x="149.3994" y="-605.5107" font-family="Times,serif" font-size="14.00" fill="#000000">α WGRESP</text>
</g>
<!-- csock -->
<g id="node3" class="node">
<title>csock</title>
<ellipse fill="none" stroke="#000000" cx="95.3994" cy="-71.3553" rx="51.3772" ry="35.2113"/>
<text text-anchor="middle" x="95.3994" y="-81.1553" font-family="Times,serif" font-size="14.00" fill="#000000">peer</text>
<text text-anchor="middle" x="95.3994" y="-67.1553" font-family="Times,serif" font-size="14.00" fill="#000000">connected</text>
<text text-anchor="middle" x="95.3994" y="-53.1553" font-family="Times,serif" font-size="14.00" fill="#000000">socket</text>
</g>
<!-- csock&#45;&gt;IFN -->
<g id="edge2" class="edge">
<title>csock&#45;&gt;IFN</title>
<path fill="none" stroke="#000000" d="M115.6286,-103.953C118.8418,-110.5956 121.6721,-117.7022 123.3994,-124.7107 128.4852,-145.3469 128.2663,-167.6808 125.3917,-188.9921"/>
<polygon fill="#000000" stroke="#000000" points="121.9089,-188.6117 123.8366,-199.0297 128.8264,-189.6835 121.9089,-188.6117"/>
<text text-anchor="start" x="128.3994" y="-169.5107" font-family="Times,serif" font-size="14.00" fill="#000000">WGINIT</text>
<text text-anchor="start" x="128.3994" y="-155.5107" font-family="Times,serif" font-size="14.00" fill="#000000">WGRESP</text>
<text text-anchor="start" x="128.3994" y="-141.5107" font-family="Times,serif" font-size="14.00" fill="#000000">WGCOOKIE</text>
<text text-anchor="start" x="128.3994" y="-127.5107" font-family="Times,serif" font-size="14.00" fill="#000000">WGDATA</text>
</g>
<!-- IFN&#45;&gt;PROXY -->
<g id="edge9" class="edge">
<title>IFN&#45;&gt;PROXY</title>
<path fill="none" stroke="#000000" d="M156.8615,-317.952C185.4167,-335.807 216.5122,-361.2375 232.3994,-393.7107 278.7309,-488.4116 265.2525,-534.3858 222.3994,-630.7107 217.9778,-640.6494 211.5706,-649.9947 204.3628,-658.4722"/>
<polygon fill="#000000" stroke="#000000" points="201.6621,-656.2404 197.5523,-666.0057 206.8548,-660.9347 201.6621,-656.2404"/>
<text text-anchor="start" x="261.3994" y="-522.0107" font-family="Times,serif" font-size="14.00" fill="#000000">β SESSID</text>
</g>
<!-- IFN&#45;&gt;csock -->
<g id="edge7" class="edge">
<title>IFN&#45;&gt;csock</title>
<path fill="none" stroke="#000000" d="M44.3151,-199.0447C36.3345,-174.6918 33.5124,-148.4443 43.1923,-124.7107 45.9515,-117.9456 50.0272,-111.5727 54.7058,-105.7472"/>
<polygon fill="#000000" stroke="#000000" points="57.4081,-107.9744 61.3924,-98.1573 52.1557,-103.3471 57.4081,-107.9744"/>
<text text-anchor="start" x="43.3994" y="-169.5107" font-family="Times,serif" font-size="14.00" fill="#000000">WGINIT</text>
<text text-anchor="start" x="43.3994" y="-155.5107" font-family="Times,serif" font-size="14.00" fill="#000000">WGRESP</text>
<text text-anchor="start" x="43.3994" y="-141.5107" font-family="Times,serif" font-size="14.00" fill="#000000">WGCOOKIE</text>
<text text-anchor="start" x="43.3994" y="-127.5107" font-family="Times,serif" font-size="14.00" fill="#000000">WGDATA</text>
</g>
<!-- IFN&#45;&gt;ENCLAVE -->
<g id="edge8" class="edge">
<title>IFN&#45;&gt;ENCLAVE</title>
<path fill="none" stroke="#000000" d="M120.9344,-375.3776C122.5109,-381.5652 124.0167,-387.7213 125.3994,-393.7107 130.1896,-414.4606 134.6097,-437.2204 138.3164,-457.9324"/>
<polygon fill="#000000" stroke="#000000" points="134.8937,-458.6776 140.0773,-467.9178 141.7873,-457.4619 134.8937,-458.6776"/>
<text text-anchor="start" x="137.3994" y="-431.5107" font-family="Times,serif" font-size="14.00" fill="#000000">β REQWGINIT</text>
<text text-anchor="start" x="137.3994" y="-417.5107" font-family="Times,serif" font-size="14.00" fill="#000000">β WGINIT</text>
<text text-anchor="start" x="137.3994" y="-403.5107" font-family="Times,serif" font-size="14.00" fill="#000000">β WGRESP</text>
</g>
<!-- ENCLAVE&#45;&gt;IFN -->
<g id="edge6" class="edge">
<title>ENCLAVE&#45;&gt;IFN</title>
<path fill="none" stroke="#000000" d="M98.7426,-478.113C94.0297,-474.4156 89.213,-470.8907 84.3994,-467.7107 68.5534,-457.2423 55.8608,-465.7202 45.6445,-449.7107 33.2013,-430.2115 33.0457,-407.4153 38.8187,-385.17"/>
<polygon fill="#000000" stroke="#000000" points="42.2454,-385.9263 41.7504,-375.343 35.5376,-383.925 42.2454,-385.9263"/>
<text text-anchor="start" x="46.3994" y="-438.5107" font-family="Times,serif" font-size="14.00" fill="#000000">β WGINIT</text>
<text text-anchor="start" x="46.3994" y="-424.5107" font-family="Times,serif" font-size="14.00" fill="#000000">β WGRESP</text>
<text text-anchor="start" x="46.3994" y="-410.5107" font-family="Times,serif" font-size="14.00" fill="#000000">β CONNREQ</text>
<text text-anchor="start" x="46.3994" y="-396.5107" font-family="Times,serif" font-size="14.00" fill="#000000">β SESSKEYS</text>
</g>
</g>
</svg>
